<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Device Control Panel</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f2f2f2;
    }
    h2 {
      text-align: center;
    }
    .add-device {
      margin-bottom: 20px;
      text-align: center;
    }
    .add-device input {
      padding: 10px;
      width: 200px;
      margin-right: 10px;
    }
    .add-device button {
      padding: 10px 20px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }
    .device {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .device h3 {
      margin-top: 0;
    }
    .device button, .device input[type=range] {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
    }
    .toggle {
      background-color: #ddd;
      border: none;
      cursor: pointer;
    }
    .toggle.active {
      background-color: #4CAF50;
      color: white;
    }
  </style>
</head>
<body>

  <h2>ESP Device Control Panel</h2>

  <div class="add-device">
    <input type="text" id="deviceIdInput" placeholder="Enter Device ID">
    <button onclick="addDevice()">Add Device</button>
  </div>

  <div class="grid" id="deviceGrid">
    <!-- Devices will be added here -->
  </div>

  <script>
    function addDevice() {
      const deviceId = document.getElementById('deviceIdInput').value;
      if (!deviceId) return alert("Enter a Device ID");

      const grid = document.getElementById('deviceGrid');
      const div = document.createElement('div');
      div.className = 'device';
      div.innerHTML = `
        <h3>Device: ${deviceId}</h3>
        <button class="toggle" onclick="toggleDevice(this, '${deviceId}')">Toggle</button>
        <input type="range" min="0" max="100" value="50" onchange="sliderChange(this, '${deviceId}')">
        <button onclick="sendCommand('${deviceId}', 'press')">Press</button>
      `;
      grid.appendChild(div);
      document.getElementById('deviceIdInput').value = '';
    }

    function toggleDevice(button, id) {
      const isActive = button.classList.toggle("active");
      const state = isActive ? "on" : "off";
      sendCommand(id, state);
    }

    function sliderChange(slider, id) {
      sendCommand(id, `slider:${slider.value}`);
    }

    function sendCommand(deviceId, command) {
      console.log(`Sending to ${deviceId}: ${command}`);
      // Replace this with your backend or Telegram logic
      // fetch('/send-command', { method: 'POST', body: JSON.stringify({ deviceId, command }) })
    }
  </script>

</body>
</html>
